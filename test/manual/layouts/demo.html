<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<title>InfiniteGrid: demo</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, target-densitydpi=medium-dpi">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.2/css/bootstrap.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootflat/2.0.4/css/bootflat.css">
<link rel="stylesheet" href="../../../demo/assets/css/demo.css">
<!--[if lt IE 9]>
<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.js"></script>
<![endif]-->
</head>
<body>
<div class="container">
	<!-- navbar -->
	<div class="row">
		<div class="col-md-12">
			<nav class="navbar navbar-inverse" role="navigation">
				<div class="container-fluid">
					<div class="navbar-header">
						<a class="navbar-brand" href="#">egjs infiniteGrid</a>
					</div>
				</div>
			</nav>
		</div>
	</div>
	<!-- infinite grid -->
	<div id="grid" class="row"></div>
</div>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-sham.js"></script>
<script src="../../../node_modules/jquery/dist/jquery.js"></script>
<!-- <script src="../../node_modules/@egjs/component/dist/component.js"></script> -->
<script src="../../../dist/infinitegrid.pkgd.js"></script>
<script src="../../../dist/GoogleLayout.js"></script>
<script src="../../../dist/GridLayout.js"></script>
<script src="../../../src/Render.js"></script>
<!--<script src="./js/demo.js"></script>-->
	<style>
		#grid.row {
			height: 1000px;
			position: relative;
		}
		.item {
			position: absolute;
			overflow: hidden;
			background-color: #fff;
			border: 1px solid #ddd;
			border-radius: 4px;
			-webkit-transition: border .2s ease-in-out;
			-o-transition: border .2s ease-in-out;
			transition: border .2s ease-in-out;
			box-shadow: 0 1px 2px rgba(0, 0, 0, .2);
			padding: 4px;
		}
		.item .thumbnail {
			background: transparent;
			border: none;
			border-radius: 0;
			box-shadow: none;
			padding: 0;
		}
	</style>
<script>
	var _a = new GoogleLayout({
		direction: "horizontal",
		margin: 20,
	});
	var a = new GoogleLayout({
		direction: "horizontal",
		margin: 20,
	});
	function imgSrc(v) {
		return "../../../demo/assets/image/" + (((v + 1) % 60) + 1) + ".jpg";
	}
	function getItem(groupNo, i) {
		const item = {
			groupKey: groupNo,
			html: '<div class="item" data-item='+i+'><div class="thumbnail"><img src="' + imgSrc(groupNo + i) + '" /><div class="caption"><p><a href="http://www.google.com/">Cras justo odio bla bla bla bla bla bla bla bla</a></p></div></div></div>',
			size: {
				width: parseInt(Math.random() * 200 + 300, 10),
				height: parseInt(Math.random() * 200 + 300, 10),
			},
			position: {

			}
		};
		const dummy = document.createElement("div");
		dummy.innerHTML = item.html;
		item.el = dummy.children[0];
		document.querySelector("#grid").appendChild(item.el);


		return item;
	}
	function getItems() {
		const group = parseInt(Math.random() * 100, 10);
		const items = [];
		for (i = 0; i < 22; ++i) {
			items.push(getItem(group, i));
		}
		return items;
	}

	a.width = document.querySelector("#grid").offsetWidth;
	a.height = document.querySelector("#grid").offsetHeight;
	let _items = [];
	function getTopline() {
		if (!_items.length) {
			return [{top:0, left: 0}];
		}
		return [{top:_items[0].position._top, left: _items[0].position._left}];
	}
	function getBottomline() {
		if (!_items.length) {
			return [{top:0, left: 0}];
		}
		return [{top:_items[_items.length - 1].position._bottom, left: _items[_items.length - 1].position._right}];
	}
	function append() {
		const items = getItems();
		console.log(getBottomline());
		a.append(items, getBottomline());
		_items = _items.concat(items);
		render(items);
	}
	function _remove(index) {
		const removed = _items.splice(index, 1);
		removed[0].el.remove();
	}
	function remove(index) {
		console.log(_items);
		a.remove(_items[index], _items, getTopline());
		_remove(index);
		render(_items);
	}
	function prepend() {
		const items = getItems();
		a.prepend(items, getTopline());
		_items = items.concat(_items);//.concat(items);
		console.log(items);
		render(items);
	}

	append();
</script>
</body>
</html>
